<ul frang-tree class="board">
    <li frang-tree-repeat="node in [getCurrentBoard()]"
        frang-tree-drag="{node: node, parent: $parent.node}"
        frang-tree-drop="drop(dragData.node, node, dragData.parent, $parent.node)"
        frang-tree-enter="enter(node)"
        frang-tree-allow-drop="allowDrop(dragData.node)">
        <div class="drop-before" ng-hide="isPreviewedAsSource(node)"></div>
        <div class="preview before" ng-if="isPreviewedAsTarget(node) && treeDrag.dropBefore && !chips.isRoot(node)">
            <board-label node="treeDrag.data.node"></board-label>
        </div>
        <div ng-hide="isPreviewedAsSource(node)">
                <!--ng-hide="treeDrag.data.node === node && treeDrag.lastHovered != node && treeDrag.lastHovered.children[0] != node">-->
            <span ng-click="boardNodes.labelClicked(node)">
                <span class="arrow"
                      ng-class="{collapsed: !boardNodes.isOpen(node), expanded: boardNodes.isOpen(node), leaf: !chips.hasChildren(node) || chips.isRoot(node)}"></span>
                <board-label node="node" ></board-label>
            </span>
            &nbsp;
            <span ng-hide="chips.isRoot(node)">
                <button class="btn btn-xs" ng-click="edit(node)"><span class="glyphicon glyphicon-pencil"></span></button>
                <button class="btn btn-xs" ng-click="mute(node)" ng-class="{'btn-danger': node.muted, active: node.muted}">
                    {{node.muted ? 'Unmute' : 'Mute'}}
                </button>
                <button class="btn btn-xs" ng-click="remove(node, $parent.node)"><span class="glyphicon glyphicon-trash"></span></button>
            </span>
        </div>
        <div class="preview after"
             ng-class="{child: chips.acceptsChildren(node)}"
             ng-if="isPreviewedAsTarget(node) && !treeDrag.dropBefore">
            <board-label node="treeDrag.data.node"></board-label>
        </div>
        <ul ng-if="chips.hasChildren(node) && boardNodes.isOpen(node)"
            frang-tree-insert-children="node.children">
        </ul>
    </li>
</ul>